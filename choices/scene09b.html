<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A Strong Companion</title>

  <!-- Fonts & Styles -->
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../css/choice-style.css" />

  <!-- Story -->
  <script>
    const storyLines = [
      "You kneel. You tilt the bottle toward the dog, as if he were asking for some. He drinks and then, light erupts.",
      "The dog's body lifts from the deck, paws outstretched.",
      "His fur glows gold and red. His body expands.",
      "Magic.",
      "He lands with a rumble and he is no longer a dog.",
      "A Highland bull. Eyes glowing orange. Horns holding golden fire. The guardian of old magic. The guardian of the queen."
    ];

    const backgroundMap = {
      0: "../images/dogDrinkin.jpg",
      2: "../images/transformDog.jpg",
      3: "../images/highlandBull.jpg"
    };

    let currentBackground = "";
    function updateBackground(lineIndex) {
      const applicableKey = Object.keys(backgroundMap)
        .map(Number)
        .reverse()
        .find(k => lineIndex >= k);

      const newBackground = backgroundMap[applicableKey];
      if (newBackground && newBackground !== currentBackground) {
        document.querySelector('.background').style.backgroundImage = `url('${newBackground}')`;
        currentBackground = newBackground;
      }
    }

    window.updateSceneBackground = updateBackground;
  </script>

  <!-- Howler & JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <script defer src="../js/choice-js.js"></script>
</head>

<body class="fade-in">
  <div class="background" style="background-image: url('../images/dogDrinkin.jpg');"></div>

  <main class="scene-wrapper">
    <h1 class="scene-title">A Strong Companion</h1>

    <div class="narrative-box">
      <button id="prev" class="arrow-btn inside" aria-label="Previous line">⬅️</button>
      <section id="typewriter" class="typewriter-container"></section>
      <button id="next" class="arrow-btn inside" aria-label="Next line">➡️</button>
    </div>

    <nav id="choices" class="choices" aria-label="Choice navigation">
      <a href="../choices/scene10_TheBattle.html" class="choice-button">Next</a>
    </nav>
  </main>

  <footer class="site-footer">
    <small>All images are AI generated.</small>
  </footer>

  <!-- Fade-out Transition Script -->
  <script>
    document.querySelectorAll('a[href]').forEach(link => {
      const href = link.getAttribute('href');
      if (href && !href.startsWith('#') && !href.startsWith('mailto:') && !href.startsWith('javascript:')) {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          document.body.classList.add('fade-out');
          setTimeout(() => {
            window.location.href = this.href;
          }, 500);
        });
      }
    });
  </script>
</body>

</html>
